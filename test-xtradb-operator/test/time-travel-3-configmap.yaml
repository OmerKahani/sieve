apiVersion: v1
kind: ConfigMap
metadata:
  name: sonar-testing-global-config
data:
  SONAR-PROJECT: xtradb-operator
  SONAR-STAGE: test
  SONAR-MODE: time-travel
  SONAR-STRAGGLER: kind-control-plane3
  SONAR-FRONT-RUNNER: kind-control-plane
  SONAR-OPERATOR-POD-LABEL: xtradb-operator
  SONAR-DEPLOYMENT-NAME: percona-xtradb-cluster-operator
  SONAR-TIMING: after
  SONAR-CE-NAME: sonar-xtradb-cluster
  SONAR-CE-NAMESPACE: default
  SONAR-CE-RTYPE: perconaxtradbcluster
  SONAR-CE-DIFF-CURRENT: '{"metadata": {"annotations": {"kubectl.kubernetes.io/last-applied-configuration":
    "{\"apiVersion\":\"pxc.percona.com/v1-9-0\",\"kind\":\"PerconaXtraDBCluster\",\"metadata\":{\"annotations\":{},\"finalizers\":[\"delete-pxc-pods-in-order\",\"delete-proxysql-pvc\",\"delete-pxc-pvc\"],\"name\":\"sonar-xtradb-cluster\",\"namespace\":\"default\"},\"spec\":{\"allowUnsafeConfigurations\":false,\"crVersion\":\"1.9.0\",\"haproxy\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-haproxy\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3},\"logCollectorSecretName\":\"sonar-log-collector-secrets\",\"logcollector\":{\"enabled\":false,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-logcollector\"},\"pmm\":{\"enabled\":false,\"image\":\"percona/pmm-client:2.12.0\",\"serverHost\":\"monitoring-service\",\"serverUser\":\"pmm\"},\"proxysql\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-proxysql\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":1,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"2Gi\"}}}}},\"pxc\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"autoRecovery\":true,\"gracePeriod\":600,\"image\":\"percona/percona-xtradb-cluster:8.0.21-12.1\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"6Gi\"}}}}},\"secretsName\":\"sonar-cluster-secrets\",\"sslInternalSecretName\":\"sonar-cluster-ssl-internal\",\"sslSecretName\":\"sonar-cluster-ssl\",\"updateStrategy\":\"RollingUpdate\",\"upgradeOptions\":{\"apply\":\"recommended\",\"schedule\":\"0
    4 * * *\",\"versionServiceEndpoint\":\"https://check.percona.com\"},\"vaultSecretName\":\"keyring-secret-vault\"}}\n"}}}'
  SONAR-CE-DIFF-PREVIOUS: '{"metadata": {"annotations": {"kubectl.kubernetes.io/last-applied-configuration":
    "{\"apiVersion\":\"pxc.percona.com/v1-9-0\",\"kind\":\"PerconaXtraDBCluster\",\"metadata\":{\"annotations\":{},\"finalizers\":[\"delete-pxc-pods-in-order\",\"delete-proxysql-pvc\",\"delete-pxc-pvc\"],\"name\":\"sonar-xtradb-cluster\",\"namespace\":\"default\"},\"spec\":{\"allowUnsafeConfigurations\":false,\"crVersion\":\"1.9.0\",\"haproxy\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-haproxy\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3},\"logCollectorSecretName\":\"sonar-log-collector-secrets\",\"logcollector\":{\"enabled\":false,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-logcollector\"},\"pmm\":{\"enabled\":false,\"image\":\"percona/pmm-client:2.12.0\",\"serverHost\":\"monitoring-service\",\"serverUser\":\"pmm\"},\"proxysql\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":true,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-proxysql\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":1,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"2Gi\"}}}}},\"pxc\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"autoRecovery\":true,\"gracePeriod\":600,\"image\":\"percona/percona-xtradb-cluster:8.0.21-12.1\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"6Gi\"}}}}},\"secretsName\":\"sonar-cluster-secrets\",\"sslInternalSecretName\":\"sonar-cluster-ssl-internal\",\"sslSecretName\":\"sonar-cluster-ssl\",\"updateStrategy\":\"RollingUpdate\",\"upgradeOptions\":{\"apply\":\"recommended\",\"schedule\":\"0
    4 * * *\",\"versionServiceEndpoint\":\"https://check.percona.com\"},\"vaultSecretName\":\"keyring-secret-vault\"}}\n"}},
    "spec": {"proxysql": {"enabled": true}}}'
  SONAR-CE-ETYPE-CURRENT: Updated
  SONAR-CE-ETYPE-PREVIOUS: Updated
  SONAR-SE-NAME: sonar-xtradb-cluster-proxysql
  SONAR-SE-NAMESPACE: default
  SONAR-SE-RTYPE: statefulset
  SONAR-SE-ETYPE: ADDED
  SONAR-DESCRIPTION: 'Pause kind-control-plane3 after it processes a default/perconaxtradbcluster/sonar-xtradb-cluster
    event E. E should match the pattern {"metadata": {"annotations": {"kubectl.kubernetes.io/last-applied-configuration":
    "{\"apiVersion\":\"pxc.percona.com/v1-9-0\",\"kind\":\"PerconaXtraDBCluster\",\"metadata\":{\"annotations\":{},\"finalizers\":[\"delete-pxc-pods-in-order\",\"delete-proxysql-pvc\",\"delete-pxc-pvc\"],\"name\":\"sonar-xtradb-cluster\",\"namespace\":\"default\"},\"spec\":{\"allowUnsafeConfigurations\":false,\"crVersion\":\"1.9.0\",\"haproxy\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-haproxy\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3},\"logCollectorSecretName\":\"sonar-log-collector-secrets\",\"logcollector\":{\"enabled\":false,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-logcollector\"},\"pmm\":{\"enabled\":false,\"image\":\"percona/pmm-client:2.12.0\",\"serverHost\":\"monitoring-service\",\"serverUser\":\"pmm\"},\"proxysql\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-proxysql\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":1,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"2Gi\"}}}}},\"pxc\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"autoRecovery\":true,\"gracePeriod\":600,\"image\":\"percona/percona-xtradb-cluster:8.0.21-12.1\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"6Gi\"}}}}},\"secretsName\":\"sonar-cluster-secrets\",\"sslInternalSecretName\":\"sonar-cluster-ssl-internal\",\"sslSecretName\":\"sonar-cluster-ssl\",\"updateStrategy\":\"RollingUpdate\",\"upgradeOptions\":{\"apply\":\"recommended\",\"schedule\":\"0
    4 * * *\",\"versionServiceEndpoint\":\"https://check.percona.com\"},\"vaultSecretName\":\"keyring-secret-vault\"}}\n"}}}
    and the events before E should match {"metadata": {"annotations": {"kubectl.kubernetes.io/last-applied-configuration":
    "{\"apiVersion\":\"pxc.percona.com/v1-9-0\",\"kind\":\"PerconaXtraDBCluster\",\"metadata\":{\"annotations\":{},\"finalizers\":[\"delete-pxc-pods-in-order\",\"delete-proxysql-pvc\",\"delete-pxc-pvc\"],\"name\":\"sonar-xtradb-cluster\",\"namespace\":\"default\"},\"spec\":{\"allowUnsafeConfigurations\":false,\"crVersion\":\"1.9.0\",\"haproxy\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":false,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-haproxy\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3},\"logCollectorSecretName\":\"sonar-log-collector-secrets\",\"logcollector\":{\"enabled\":false,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-logcollector\"},\"pmm\":{\"enabled\":false,\"image\":\"percona/pmm-client:2.12.0\",\"serverHost\":\"monitoring-service\",\"serverUser\":\"pmm\"},\"proxysql\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"enabled\":true,\"gracePeriod\":30,\"image\":\"percona/percona-xtradb-cluster-operator:1.8.0-proxysql\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":1,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"2Gi\"}}}}},\"pxc\":{\"affinity\":{\"antiAffinityTopologyKey\":\"kubernetes.io/hostname\"},\"autoRecovery\":true,\"gracePeriod\":600,\"image\":\"percona/percona-xtradb-cluster:8.0.21-12.1\",\"podDisruptionBudget\":{\"maxUnavailable\":1},\"resources\":{\"requests\":{\"cpu\":\"600m\",\"memory\":\"1G\"}},\"size\":3,\"volumeSpec\":{\"persistentVolumeClaim\":{\"resources\":{\"requests\":{\"storage\":\"6Gi\"}}}}},\"secretsName\":\"sonar-cluster-secrets\",\"sslInternalSecretName\":\"sonar-cluster-ssl-internal\",\"sslSecretName\":\"sonar-cluster-ssl\",\"updateStrategy\":\"RollingUpdate\",\"upgradeOptions\":{\"apply\":\"recommended\",\"schedule\":\"0
    4 * * *\",\"versionServiceEndpoint\":\"https://check.percona.com\"},\"vaultSecretName\":\"keyring-secret-vault\"}}\n"}},
    "spec": {"proxysql": {"enabled": true}}}. And restart the controller xtradb-operator
    after kind-control-plane processes a ADDED default/statefulset/sonar-xtradb-cluster-proxysql
    event.'
