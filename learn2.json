{"pod": [{"metadata": {"name": "rabbitmq-cluster-server-0", "generateName": "rabbitmq-cluster-server-", "namespace": "default", "selfLink": "/api/v1/namespaces/default/pods/rabbitmq-cluster-server-0", "uid": "a54f8f60-085f-44b8-a8d7-f0f44c6c3e53", "resourceVersion": "1455", "creationTimestamp": "2021-08-01T07:52:58Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq", "controller-revision-hash": "rabbitmq-cluster-server-5f8b8665fb", "statefulset.kubernetes.io/pod-name": "rabbitmq-cluster-server-0"}, "annotations": {"prometheus.io/port": "15692", "prometheus.io/scrape": "true"}, "ownerReferences": [{"apiVersion": "apps/v1", "kind": "StatefulSet", "name": "rabbitmq-cluster-server", "uid": "1cb70b36-745d-4131-84d0-6cbf436c65d3", "controller": true, "blockOwnerDeletion": true}], "managedFields": [{"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:52:58Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:prometheus.io/port": {}, "f:prometheus.io/scrape": {}}, "f:generateName": {}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}, "f:controller-revision-hash": {}, "f:statefulset.kubernetes.io/pod-name": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"1cb70b36-745d-4131-84d0-6cbf436c65d3\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:automountServiceAccountToken": {}, "f:containers": {"k:{\"name\":\"rabbitmq\"}": {".": {}, "f:env": {".": {}, "k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"K8S_SERVICE_NAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"MY_POD_NAME\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"MY_POD_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_NODENAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}": {".": {}, "f:name": {}, "f:value": {}}}, "f:image": {}, "f:imagePullPolicy": {}, "f:lifecycle": {".": {}, "f:preStop": {".": {}, "f:exec": {".": {}, "f:command": {}}}}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":4369,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":5672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15692,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:readinessProbe": {".": {}, "f:failureThreshold": {}, "f:initialDelaySeconds": {}, "f:periodSeconds": {}, "f:successThreshold": {}, "f:tcpSocket": {".": {}, "f:port": {}}, "f:timeoutSeconds": {}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/etc/pod-info/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:dnsPolicy": {}, "f:enableServiceLinks": {}, "f:hostname": {}, "f:initContainers": {".": {}, "k:{\"name\":\"setup-container\"}": {".": {}, "f:command": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:securityContext": {".": {}, "f:capabilities": {".": {}, "f:drop": {}}, "f:runAsUser": {}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:subdomain": {}, "f:terminationGracePeriodSeconds": {}, "f:topologySpreadConstraints": {".": {}, "k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}": {".": {}, "f:labelSelector": {".": {}, "f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}}}, "f:maxSkew": {}, "f:topologyKey": {}, "f:whenUnsatisfiable": {}}}, "f:volumes": {".": {}, "k:{\"name\":\"erlang-cookie-secret\"}": {".": {}, "f:name": {}, "f:secret": {".": {}, "f:defaultMode": {}, "f:secretName": {}}}, "k:{\"name\":\"persistence\"}": {".": {}, "f:name": {}, "f:persistentVolumeClaim": {".": {}, "f:claimName": {}}}, "k:{\"name\":\"plugins-conf\"}": {".": {}, "f:configMap": {".": {}, "f:defaultMode": {}, "f:name": {}}, "f:name": {}}, "k:{\"name\":\"pod-info\"}": {".": {}, "f:downwardAPI": {".": {}, "f:defaultMode": {}, "f:items": {}}, "f:name": {}}, "k:{\"name\":\"rabbitmq-confd\"}": {".": {}, "f:name": {}, "f:projected": {".": {}, "f:defaultMode": {}, "f:sources": {}}}, "k:{\"name\":\"rabbitmq-erlang-cookie\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}, "k:{\"name\":\"rabbitmq-plugins\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}}}}}, {"manager": "kubelet", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:02Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:status": {"f:conditions": {"k:{\"type\":\"ContainersReady\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Initialized\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Ready\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}}, "f:containerStatuses": {}, "f:hostIP": {}, "f:initContainerStatuses": {}, "f:phase": {}, "f:podIP": {}, "f:podIPs": {".": {}, "k:{\"ip\":\"10.244.4.3\"}": {".": {}, "f:ip": {}}}, "f:startTime": {}}}}]}, "spec": {"volumes": [{"name": "persistence", "persistentVolumeClaim": {"claimName": "persistence-rabbitmq-cluster-server-0"}}, {"name": "plugins-conf", "configMap": {"name": "rabbitmq-cluster-plugins-conf", "defaultMode": 420}}, {"name": "rabbitmq-confd", "projected": {"sources": [{"secret": {"name": "rabbitmq-cluster-default-user", "items": [{"key": "default_user.conf", "path": "default_user.conf"}]}}, {"configMap": {"name": "rabbitmq-cluster-server-conf", "items": [{"key": "operatorDefaults.conf", "path": "operatorDefaults.conf"}, {"key": "userDefinedConfiguration.conf", "path": "userDefinedConfiguration.conf"}]}}], "defaultMode": 420}}, {"name": "rabbitmq-erlang-cookie", "emptyDir": {}}, {"name": "erlang-cookie-secret", "secret": {"secretName": "rabbitmq-cluster-erlang-cookie", "defaultMode": 420}}, {"name": "rabbitmq-plugins", "emptyDir": {}}, {"name": "pod-info", "downwardAPI": {"items": [{"path": "skipPreStopChecks", "fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.labels['skipPreStopChecks']"}}], "defaultMode": 420}}, {"name": "rabbitmq-cluster-server-token-rflv5", "secret": {"secretName": "rabbitmq-cluster-server-token-rflv5", "defaultMode": 420}}], "initContainers": [{"name": "setup-container", "image": "rabbitmq:3.8.12-management", "command": ["sh", "-c", "cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie && chown 999:999 /var/lib/rabbitmq/.erlang.cookie && chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins && chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' > /var/lib/rabbitmq/.rabbitmqadmin.conf && sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf >> /var/lib/rabbitmq/.rabbitmqadmin.conf && chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf && chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"], "resources": {"limits": {"cpu": "100m", "memory": "500Mi"}, "requests": {"cpu": "100m", "memory": "500Mi"}}, "volumeMounts": [{"name": "plugins-conf", "mountPath": "/tmp/rabbitmq-plugins/"}, {"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "erlang-cookie-secret", "mountPath": "/tmp/erlang-cookie-secret/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-confd", "mountPath": "/tmp/default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent", "securityContext": {"capabilities": {"drop": ["FSETID", "KILL", "SETGID", "SETUID", "SETPCAP", "NET_BIND_SERVICE", "NET_RAW", "SYS_CHROOT", "MKNOD", "AUDIT_WRITE", "SETFCAP"]}, "runAsUser": 0}}], "containers": [{"name": "rabbitmq", "image": "rabbitmq:3.8.12-management", "ports": [{"name": "epmd", "containerPort": 4369, "protocol": "TCP"}, {"name": "amqp", "containerPort": 5672, "protocol": "TCP"}, {"name": "management", "containerPort": 15672, "protocol": "TCP"}, {"name": "prometheus", "containerPort": 15692, "protocol": "TCP"}], "env": [{"name": "MY_POD_NAME", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.name"}}}, {"name": "MY_POD_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "RABBITMQ_ENABLED_PLUGINS_FILE", "value": "/operator/enabled_plugins"}, {"name": "K8S_SERVICE_NAME", "value": "rabbitmq-cluster-nodes"}, {"name": "RABBITMQ_USE_LONGNAME", "value": "true"}, {"name": "RABBITMQ_NODENAME", "value": "rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}, {"name": "K8S_HOSTNAME_SUFFIX", "value": ".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}], "resources": {"limits": {"cpu": "2", "memory": "2Gi"}, "requests": {"cpu": "1", "memory": "2Gi"}}, "volumeMounts": [{"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/10-operatorDefaults.conf", "subPath": "operatorDefaults.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/11-default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf", "subPath": "userDefinedConfiguration.conf"}, {"name": "pod-info", "mountPath": "/etc/pod-info/"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "readinessProbe": {"tcpSocket": {"port": "amqp"}, "initialDelaySeconds": 10, "timeoutSeconds": 5, "periodSeconds": 10, "successThreshold": 1, "failureThreshold": 3}, "lifecycle": {"preStop": {"exec": {"command": ["/bin/bash", "-c", "if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 604800, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-server", "serviceAccount": "rabbitmq-cluster-server", "automountServiceAccountToken": true, "nodeName": "kind-worker2", "securityContext": {"runAsUser": 999, "runAsGroup": 999, "fsGroup": 999}, "hostname": "rabbitmq-cluster-server-0", "subdomain": "rabbitmq-cluster-nodes", "schedulerName": "default-scheduler", "tolerations": [{"key": "node.kubernetes.io/not-ready", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}, {"key": "node.kubernetes.io/unreachable", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}], "priority": 0, "enableServiceLinks": true, "topologySpreadConstraints": [{"maxSkew": 1, "topologyKey": "topology.kubernetes.io/zone", "whenUnsatisfiable": "ScheduleAnyway", "labelSelector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster"}}}]}, "status": {"phase": "Running", "conditions": [{"type": "Initialized", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:53:16Z"}, {"type": "Ready", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:02Z"}, {"type": "ContainersReady", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:02Z"}, {"type": "PodScheduled", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:53:02Z"}], "hostIP": "172.18.0.5", "podIP": "10.244.4.3", "podIPs": [{"ip": "10.244.4.3"}], "startTime": "2021-08-01T07:53:02Z", "initContainerStatuses": [{"name": "setup-container", "state": {"terminated": {"exitCode": 0, "reason": "Completed", "startedAt": "2021-08-01T07:53:15Z", "finishedAt": "2021-08-01T07:53:16Z", "containerID": "containerd://656075f67aec08b55c41c37361e3ee5b71439197f6a7dc14c942a9a95b006cc4"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://656075f67aec08b55c41c37361e3ee5b71439197f6a7dc14c942a9a95b006cc4"}], "containerStatuses": [{"name": "rabbitmq", "state": {"running": {"startedAt": "2021-08-01T07:53:16Z"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://bfd4449a00d4206f945d67c3f198124d179826d4858ee57081afce0aa2feffe7", "started": true}], "qosClass": "Burstable"}}, {"metadata": {"name": "rabbitmq-cluster-server-1", "generateName": "rabbitmq-cluster-server-", "namespace": "default", "selfLink": "/api/v1/namespaces/default/pods/rabbitmq-cluster-server-1", "uid": "1bfb723e-e949-423b-bf3a-e44f827299af", "resourceVersion": "1874", "creationTimestamp": "2021-08-01T07:54:12Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq", "controller-revision-hash": "rabbitmq-cluster-server-5f8b8665fb", "statefulset.kubernetes.io/pod-name": "rabbitmq-cluster-server-1"}, "annotations": {"prometheus.io/port": "15692", "prometheus.io/scrape": "true"}, "ownerReferences": [{"apiVersion": "apps/v1", "kind": "StatefulSet", "name": "rabbitmq-cluster-server", "uid": "1cb70b36-745d-4131-84d0-6cbf436c65d3", "controller": true, "blockOwnerDeletion": true}], "managedFields": [{"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:12Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:prometheus.io/port": {}, "f:prometheus.io/scrape": {}}, "f:generateName": {}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}, "f:controller-revision-hash": {}, "f:statefulset.kubernetes.io/pod-name": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"1cb70b36-745d-4131-84d0-6cbf436c65d3\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:automountServiceAccountToken": {}, "f:containers": {"k:{\"name\":\"rabbitmq\"}": {".": {}, "f:env": {".": {}, "k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"K8S_SERVICE_NAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"MY_POD_NAME\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"MY_POD_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_NODENAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}": {".": {}, "f:name": {}, "f:value": {}}}, "f:image": {}, "f:imagePullPolicy": {}, "f:lifecycle": {".": {}, "f:preStop": {".": {}, "f:exec": {".": {}, "f:command": {}}}}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":4369,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":5672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15692,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:readinessProbe": {".": {}, "f:failureThreshold": {}, "f:initialDelaySeconds": {}, "f:periodSeconds": {}, "f:successThreshold": {}, "f:tcpSocket": {".": {}, "f:port": {}}, "f:timeoutSeconds": {}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/etc/pod-info/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:dnsPolicy": {}, "f:enableServiceLinks": {}, "f:hostname": {}, "f:initContainers": {".": {}, "k:{\"name\":\"setup-container\"}": {".": {}, "f:command": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:securityContext": {".": {}, "f:capabilities": {".": {}, "f:drop": {}}, "f:runAsUser": {}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:subdomain": {}, "f:terminationGracePeriodSeconds": {}, "f:topologySpreadConstraints": {".": {}, "k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}": {".": {}, "f:labelSelector": {".": {}, "f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}}}, "f:maxSkew": {}, "f:topologyKey": {}, "f:whenUnsatisfiable": {}}}, "f:volumes": {".": {}, "k:{\"name\":\"erlang-cookie-secret\"}": {".": {}, "f:name": {}, "f:secret": {".": {}, "f:defaultMode": {}, "f:secretName": {}}}, "k:{\"name\":\"persistence\"}": {".": {}, "f:name": {}, "f:persistentVolumeClaim": {".": {}, "f:claimName": {}}}, "k:{\"name\":\"plugins-conf\"}": {".": {}, "f:configMap": {".": {}, "f:defaultMode": {}, "f:name": {}}, "f:name": {}}, "k:{\"name\":\"pod-info\"}": {".": {}, "f:downwardAPI": {".": {}, "f:defaultMode": {}, "f:items": {}}, "f:name": {}}, "k:{\"name\":\"rabbitmq-confd\"}": {".": {}, "f:name": {}, "f:projected": {".": {}, "f:defaultMode": {}, "f:sources": {}}}, "k:{\"name\":\"rabbitmq-erlang-cookie\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}, "k:{\"name\":\"rabbitmq-plugins\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}}}}}, {"manager": "kubelet", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:55:14Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:status": {"f:conditions": {"k:{\"type\":\"ContainersReady\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Initialized\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Ready\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}}, "f:containerStatuses": {}, "f:hostIP": {}, "f:initContainerStatuses": {}, "f:phase": {}, "f:podIP": {}, "f:podIPs": {".": {}, "k:{\"ip\":\"10.244.3.5\"}": {".": {}, "f:ip": {}}}, "f:startTime": {}}}}]}, "spec": {"volumes": [{"name": "persistence", "persistentVolumeClaim": {"claimName": "persistence-rabbitmq-cluster-server-1"}}, {"name": "plugins-conf", "configMap": {"name": "rabbitmq-cluster-plugins-conf", "defaultMode": 420}}, {"name": "rabbitmq-confd", "projected": {"sources": [{"secret": {"name": "rabbitmq-cluster-default-user", "items": [{"key": "default_user.conf", "path": "default_user.conf"}]}}, {"configMap": {"name": "rabbitmq-cluster-server-conf", "items": [{"key": "operatorDefaults.conf", "path": "operatorDefaults.conf"}, {"key": "userDefinedConfiguration.conf", "path": "userDefinedConfiguration.conf"}]}}], "defaultMode": 420}}, {"name": "rabbitmq-erlang-cookie", "emptyDir": {}}, {"name": "erlang-cookie-secret", "secret": {"secretName": "rabbitmq-cluster-erlang-cookie", "defaultMode": 420}}, {"name": "rabbitmq-plugins", "emptyDir": {}}, {"name": "pod-info", "downwardAPI": {"items": [{"path": "skipPreStopChecks", "fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.labels['skipPreStopChecks']"}}], "defaultMode": 420}}, {"name": "rabbitmq-cluster-server-token-rflv5", "secret": {"secretName": "rabbitmq-cluster-server-token-rflv5", "defaultMode": 420}}], "initContainers": [{"name": "setup-container", "image": "rabbitmq:3.8.12-management", "command": ["sh", "-c", "cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie && chown 999:999 /var/lib/rabbitmq/.erlang.cookie && chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins && chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' > /var/lib/rabbitmq/.rabbitmqadmin.conf && sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf >> /var/lib/rabbitmq/.rabbitmqadmin.conf && chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf && chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"], "resources": {"limits": {"cpu": "100m", "memory": "500Mi"}, "requests": {"cpu": "100m", "memory": "500Mi"}}, "volumeMounts": [{"name": "plugins-conf", "mountPath": "/tmp/rabbitmq-plugins/"}, {"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "erlang-cookie-secret", "mountPath": "/tmp/erlang-cookie-secret/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-confd", "mountPath": "/tmp/default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent", "securityContext": {"capabilities": {"drop": ["FSETID", "KILL", "SETGID", "SETUID", "SETPCAP", "NET_BIND_SERVICE", "NET_RAW", "SYS_CHROOT", "MKNOD", "AUDIT_WRITE", "SETFCAP"]}, "runAsUser": 0}}], "containers": [{"name": "rabbitmq", "image": "rabbitmq:3.8.12-management", "ports": [{"name": "epmd", "containerPort": 4369, "protocol": "TCP"}, {"name": "amqp", "containerPort": 5672, "protocol": "TCP"}, {"name": "management", "containerPort": 15672, "protocol": "TCP"}, {"name": "prometheus", "containerPort": 15692, "protocol": "TCP"}], "env": [{"name": "MY_POD_NAME", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.name"}}}, {"name": "MY_POD_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "RABBITMQ_ENABLED_PLUGINS_FILE", "value": "/operator/enabled_plugins"}, {"name": "K8S_SERVICE_NAME", "value": "rabbitmq-cluster-nodes"}, {"name": "RABBITMQ_USE_LONGNAME", "value": "true"}, {"name": "RABBITMQ_NODENAME", "value": "rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}, {"name": "K8S_HOSTNAME_SUFFIX", "value": ".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}], "resources": {"limits": {"cpu": "2", "memory": "2Gi"}, "requests": {"cpu": "1", "memory": "2Gi"}}, "volumeMounts": [{"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/10-operatorDefaults.conf", "subPath": "operatorDefaults.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/11-default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf", "subPath": "userDefinedConfiguration.conf"}, {"name": "pod-info", "mountPath": "/etc/pod-info/"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "readinessProbe": {"tcpSocket": {"port": "amqp"}, "initialDelaySeconds": 10, "timeoutSeconds": 5, "periodSeconds": 10, "successThreshold": 1, "failureThreshold": 3}, "lifecycle": {"preStop": {"exec": {"command": ["/bin/bash", "-c", "if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 604800, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-server", "serviceAccount": "rabbitmq-cluster-server", "automountServiceAccountToken": true, "nodeName": "kind-worker", "securityContext": {"runAsUser": 999, "runAsGroup": 999, "fsGroup": 999}, "hostname": "rabbitmq-cluster-server-1", "subdomain": "rabbitmq-cluster-nodes", "schedulerName": "default-scheduler", "tolerations": [{"key": "node.kubernetes.io/not-ready", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}, {"key": "node.kubernetes.io/unreachable", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}], "priority": 0, "enableServiceLinks": true, "topologySpreadConstraints": [{"maxSkew": 1, "topologyKey": "topology.kubernetes.io/zone", "whenUnsatisfiable": "ScheduleAnyway", "labelSelector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster"}}}]}, "status": {"phase": "Running", "conditions": [{"type": "Initialized", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:30Z"}, {"type": "Ready", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:55:14Z"}, {"type": "ContainersReady", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:55:14Z"}, {"type": "PodScheduled", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:16Z"}], "hostIP": "172.18.0.4", "podIP": "10.244.3.5", "podIPs": [{"ip": "10.244.3.5"}], "startTime": "2021-08-01T07:54:16Z", "initContainerStatuses": [{"name": "setup-container", "state": {"terminated": {"exitCode": 0, "reason": "Completed", "startedAt": "2021-08-01T07:54:29Z", "finishedAt": "2021-08-01T07:54:30Z", "containerID": "containerd://bd5f05dc2fda61cfcdad97488ab2a026eed277e115d759f1a44afea2d6611187"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://bd5f05dc2fda61cfcdad97488ab2a026eed277e115d759f1a44afea2d6611187"}], "containerStatuses": [{"name": "rabbitmq", "state": {"running": {"startedAt": "2021-08-01T07:54:30Z"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://13f247b6fe512bfe949eed45e55a795e6246bee1343c499de404e35fcce9b502", "started": true}], "qosClass": "Burstable"}}, {"metadata": {"name": "rabbitmq-cluster-server-2", "generateName": "rabbitmq-cluster-server-", "namespace": "default", "selfLink": "/api/v1/namespaces/default/pods/rabbitmq-cluster-server-2", "uid": "5b794991-e684-42b3-b680-a7f19c696fa0", "resourceVersion": "1885", "creationTimestamp": "2021-08-01T07:54:12Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq", "controller-revision-hash": "rabbitmq-cluster-server-5f8b8665fb", "statefulset.kubernetes.io/pod-name": "rabbitmq-cluster-server-2"}, "annotations": {"prometheus.io/port": "15692", "prometheus.io/scrape": "true"}, "ownerReferences": [{"apiVersion": "apps/v1", "kind": "StatefulSet", "name": "rabbitmq-cluster-server", "uid": "1cb70b36-745d-4131-84d0-6cbf436c65d3", "controller": true, "blockOwnerDeletion": true}], "managedFields": [{"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:12Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:prometheus.io/port": {}, "f:prometheus.io/scrape": {}}, "f:generateName": {}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}, "f:controller-revision-hash": {}, "f:statefulset.kubernetes.io/pod-name": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"1cb70b36-745d-4131-84d0-6cbf436c65d3\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:automountServiceAccountToken": {}, "f:containers": {"k:{\"name\":\"rabbitmq\"}": {".": {}, "f:env": {".": {}, "k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"K8S_SERVICE_NAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"MY_POD_NAME\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"MY_POD_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_NODENAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}": {".": {}, "f:name": {}, "f:value": {}}}, "f:image": {}, "f:imagePullPolicy": {}, "f:lifecycle": {".": {}, "f:preStop": {".": {}, "f:exec": {".": {}, "f:command": {}}}}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":4369,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":5672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15692,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:readinessProbe": {".": {}, "f:failureThreshold": {}, "f:initialDelaySeconds": {}, "f:periodSeconds": {}, "f:successThreshold": {}, "f:tcpSocket": {".": {}, "f:port": {}}, "f:timeoutSeconds": {}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/etc/pod-info/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:dnsPolicy": {}, "f:enableServiceLinks": {}, "f:hostname": {}, "f:initContainers": {".": {}, "k:{\"name\":\"setup-container\"}": {".": {}, "f:command": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:securityContext": {".": {}, "f:capabilities": {".": {}, "f:drop": {}}, "f:runAsUser": {}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:subdomain": {}, "f:terminationGracePeriodSeconds": {}, "f:topologySpreadConstraints": {".": {}, "k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}": {".": {}, "f:labelSelector": {".": {}, "f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}}}, "f:maxSkew": {}, "f:topologyKey": {}, "f:whenUnsatisfiable": {}}}, "f:volumes": {".": {}, "k:{\"name\":\"erlang-cookie-secret\"}": {".": {}, "f:name": {}, "f:secret": {".": {}, "f:defaultMode": {}, "f:secretName": {}}}, "k:{\"name\":\"persistence\"}": {".": {}, "f:name": {}, "f:persistentVolumeClaim": {".": {}, "f:claimName": {}}}, "k:{\"name\":\"plugins-conf\"}": {".": {}, "f:configMap": {".": {}, "f:defaultMode": {}, "f:name": {}}, "f:name": {}}, "k:{\"name\":\"pod-info\"}": {".": {}, "f:downwardAPI": {".": {}, "f:defaultMode": {}, "f:items": {}}, "f:name": {}}, "k:{\"name\":\"rabbitmq-confd\"}": {".": {}, "f:name": {}, "f:projected": {".": {}, "f:defaultMode": {}, "f:sources": {}}}, "k:{\"name\":\"rabbitmq-erlang-cookie\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}, "k:{\"name\":\"rabbitmq-plugins\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}}}}}, {"manager": "kubelet", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:55:15Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:status": {"f:conditions": {"k:{\"type\":\"ContainersReady\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Initialized\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Ready\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}}, "f:containerStatuses": {}, "f:hostIP": {}, "f:initContainerStatuses": {}, "f:phase": {}, "f:podIP": {}, "f:podIPs": {".": {}, "k:{\"ip\":\"10.244.3.6\"}": {".": {}, "f:ip": {}}}, "f:startTime": {}}}}]}, "spec": {"volumes": [{"name": "persistence", "persistentVolumeClaim": {"claimName": "persistence-rabbitmq-cluster-server-2"}}, {"name": "plugins-conf", "configMap": {"name": "rabbitmq-cluster-plugins-conf", "defaultMode": 420}}, {"name": "rabbitmq-confd", "projected": {"sources": [{"secret": {"name": "rabbitmq-cluster-default-user", "items": [{"key": "default_user.conf", "path": "default_user.conf"}]}}, {"configMap": {"name": "rabbitmq-cluster-server-conf", "items": [{"key": "operatorDefaults.conf", "path": "operatorDefaults.conf"}, {"key": "userDefinedConfiguration.conf", "path": "userDefinedConfiguration.conf"}]}}], "defaultMode": 420}}, {"name": "rabbitmq-erlang-cookie", "emptyDir": {}}, {"name": "erlang-cookie-secret", "secret": {"secretName": "rabbitmq-cluster-erlang-cookie", "defaultMode": 420}}, {"name": "rabbitmq-plugins", "emptyDir": {}}, {"name": "pod-info", "downwardAPI": {"items": [{"path": "skipPreStopChecks", "fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.labels['skipPreStopChecks']"}}], "defaultMode": 420}}, {"name": "rabbitmq-cluster-server-token-rflv5", "secret": {"secretName": "rabbitmq-cluster-server-token-rflv5", "defaultMode": 420}}], "initContainers": [{"name": "setup-container", "image": "rabbitmq:3.8.12-management", "command": ["sh", "-c", "cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie && chown 999:999 /var/lib/rabbitmq/.erlang.cookie && chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins && chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' > /var/lib/rabbitmq/.rabbitmqadmin.conf && sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf >> /var/lib/rabbitmq/.rabbitmqadmin.conf && chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf && chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"], "resources": {"limits": {"cpu": "100m", "memory": "500Mi"}, "requests": {"cpu": "100m", "memory": "500Mi"}}, "volumeMounts": [{"name": "plugins-conf", "mountPath": "/tmp/rabbitmq-plugins/"}, {"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "erlang-cookie-secret", "mountPath": "/tmp/erlang-cookie-secret/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-confd", "mountPath": "/tmp/default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent", "securityContext": {"capabilities": {"drop": ["FSETID", "KILL", "SETGID", "SETUID", "SETPCAP", "NET_BIND_SERVICE", "NET_RAW", "SYS_CHROOT", "MKNOD", "AUDIT_WRITE", "SETFCAP"]}, "runAsUser": 0}}], "containers": [{"name": "rabbitmq", "image": "rabbitmq:3.8.12-management", "ports": [{"name": "epmd", "containerPort": 4369, "protocol": "TCP"}, {"name": "amqp", "containerPort": 5672, "protocol": "TCP"}, {"name": "management", "containerPort": 15672, "protocol": "TCP"}, {"name": "prometheus", "containerPort": 15692, "protocol": "TCP"}], "env": [{"name": "MY_POD_NAME", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.name"}}}, {"name": "MY_POD_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "RABBITMQ_ENABLED_PLUGINS_FILE", "value": "/operator/enabled_plugins"}, {"name": "K8S_SERVICE_NAME", "value": "rabbitmq-cluster-nodes"}, {"name": "RABBITMQ_USE_LONGNAME", "value": "true"}, {"name": "RABBITMQ_NODENAME", "value": "rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}, {"name": "K8S_HOSTNAME_SUFFIX", "value": ".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}], "resources": {"limits": {"cpu": "2", "memory": "2Gi"}, "requests": {"cpu": "1", "memory": "2Gi"}}, "volumeMounts": [{"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/10-operatorDefaults.conf", "subPath": "operatorDefaults.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/11-default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf", "subPath": "userDefinedConfiguration.conf"}, {"name": "pod-info", "mountPath": "/etc/pod-info/"}, {"name": "rabbitmq-cluster-server-token-rflv5", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "readinessProbe": {"tcpSocket": {"port": "amqp"}, "initialDelaySeconds": 10, "timeoutSeconds": 5, "periodSeconds": 10, "successThreshold": 1, "failureThreshold": 3}, "lifecycle": {"preStop": {"exec": {"command": ["/bin/bash", "-c", "if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 604800, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-server", "serviceAccount": "rabbitmq-cluster-server", "automountServiceAccountToken": true, "nodeName": "kind-worker", "securityContext": {"runAsUser": 999, "runAsGroup": 999, "fsGroup": 999}, "hostname": "rabbitmq-cluster-server-2", "subdomain": "rabbitmq-cluster-nodes", "schedulerName": "default-scheduler", "tolerations": [{"key": "node.kubernetes.io/not-ready", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}, {"key": "node.kubernetes.io/unreachable", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}], "priority": 0, "enableServiceLinks": true, "topologySpreadConstraints": [{"maxSkew": 1, "topologyKey": "topology.kubernetes.io/zone", "whenUnsatisfiable": "ScheduleAnyway", "labelSelector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster"}}}]}, "status": {"phase": "Running", "conditions": [{"type": "Initialized", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:32Z"}, {"type": "Ready", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:55:15Z"}, {"type": "ContainersReady", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:55:15Z"}, {"type": "PodScheduled", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:54:16Z"}], "hostIP": "172.18.0.4", "podIP": "10.244.3.6", "podIPs": [{"ip": "10.244.3.6"}], "startTime": "2021-08-01T07:54:16Z", "initContainerStatuses": [{"name": "setup-container", "state": {"terminated": {"exitCode": 0, "reason": "Completed", "startedAt": "2021-08-01T07:54:31Z", "finishedAt": "2021-08-01T07:54:31Z", "containerID": "containerd://7d353b28d6a9a40452f009dc59b0ba8db4af6466c61ee5b7ae39084663bbb855"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://7d353b28d6a9a40452f009dc59b0ba8db4af6466c61ee5b7ae39084663bbb855"}], "containerStatuses": [{"name": "rabbitmq", "state": {"running": {"startedAt": "2021-08-01T07:54:32Z"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/library/rabbitmq:3.8.12-management", "imageID": "docker.io/library/rabbitmq@sha256:00ad24aace28bee5f903a3ce89c6e538d99a86dd764a2f86e26ef9a48327a66b", "containerID": "containerd://523ce1c69a81eef5ec44e1b0b7c321b3b3b733cbb55fca77c5fb34be05dde580", "started": true}], "qosClass": "Burstable"}}, {"metadata": {"name": "rabbitmq-operator-66cd695d47-826qr", "generateName": "rabbitmq-operator-66cd695d47-", "namespace": "default", "selfLink": "/api/v1/namespaces/default/pods/rabbitmq-operator-66cd695d47-826qr", "uid": "54270102-dcfd-4763-a7fe-3d908d397770", "resourceVersion": "971", "creationTimestamp": "2021-08-01T07:52:30Z", "labels": {"app.kubernetes.io/component": "rabbitmq-cluster-operator", "app.kubernetes.io/name": "rabbitmq-cluster-operator", "app.kubernetes.io/part-of": "rabbitmq", "pod-template-hash": "66cd695d47", "sonartag": "rabbitmq-operator"}, "ownerReferences": [{"apiVersion": "apps/v1", "kind": "ReplicaSet", "name": "rabbitmq-operator-66cd695d47", "uid": "364776e8-6500-4c88-9840-ca132c504a14", "controller": true, "blockOwnerDeletion": true}], "managedFields": [{"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:52:30Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:generateName": {}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}, "f:pod-template-hash": {}, "f:sonartag": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"364776e8-6500-4c88-9840-ca132c504a14\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:containers": {"k:{\"name\":\"operator\"}": {".": {}, "f:command": {}, "f:env": {".": {}, "k:{\"name\":\"KUBERNETES_SERVICE_HOST\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"KUBERNETES_SERVICE_PORT\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"OPERATOR_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}}, "f:envFrom": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":9782,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}}}, "f:dnsPolicy": {}, "f:enableServiceLinks": {}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:terminationGracePeriodSeconds": {}}}}, {"manager": "kubelet", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:52:32Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:status": {"f:conditions": {"k:{\"type\":\"ContainersReady\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Initialized\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Ready\"}": {".": {}, "f:lastProbeTime": {}, "f:lastTransitionTime": {}, "f:status": {}, "f:type": {}}}, "f:containerStatuses": {}, "f:hostIP": {}, "f:phase": {}, "f:podIP": {}, "f:podIPs": {".": {}, "k:{\"ip\":\"10.244.3.2\"}": {".": {}, "f:ip": {}}}, "f:startTime": {}}}}]}, "spec": {"volumes": [{"name": "rabbitmq-cluster-operator-token-hjwzq", "secret": {"secretName": "rabbitmq-cluster-operator-token-hjwzq", "defaultMode": 420}}], "containers": [{"name": "operator", "image": "laphets/rabbitmq-operator:learn", "command": ["/manager"], "ports": [{"name": "metrics", "containerPort": 9782, "protocol": "TCP"}], "envFrom": [{"configMapRef": {"name": "sonar-testing-global-config"}}], "env": [{"name": "OPERATOR_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "resources": {"limits": {"cpu": "200m", "memory": "500Mi"}, "requests": {"cpu": "200m", "memory": "500Mi"}}, "volumeMounts": [{"name": "rabbitmq-cluster-operator-token-hjwzq", "readOnly": true, "mountPath": "/var/run/secrets/kubernetes.io/serviceaccount"}], "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 10, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-operator", "serviceAccount": "rabbitmq-cluster-operator", "nodeName": "kind-worker", "securityContext": {"runAsUser": 1000, "runAsGroup": 1000, "fsGroup": 1000}, "schedulerName": "default-scheduler", "tolerations": [{"key": "node.kubernetes.io/not-ready", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}, {"key": "node.kubernetes.io/unreachable", "operator": "Exists", "effect": "NoExecute", "tolerationSeconds": 300}], "priority": 0, "enableServiceLinks": true}, "status": {"phase": "Running", "conditions": [{"type": "Initialized", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:52:30Z"}, {"type": "Ready", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:52:32Z"}, {"type": "ContainersReady", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:52:32Z"}, {"type": "PodScheduled", "status": "True", "lastProbeTime": null, "lastTransitionTime": "2021-08-01T07:52:30Z"}], "hostIP": "172.18.0.4", "podIP": "10.244.3.2", "podIPs": [{"ip": "10.244.3.2"}], "startTime": "2021-08-01T07:52:30Z", "containerStatuses": [{"name": "operator", "state": {"running": {"startedAt": "2021-08-01T07:52:32Z"}}, "lastState": {}, "ready": true, "restartCount": 0, "image": "docker.io/laphets/rabbitmq-operator:learn", "imageID": "sha256:1ea8c61a8dc5d1a8bbebb35c851f37902391d4da9a2a4b47b41168e797da64d1", "containerID": "containerd://e80dfe0d41f52f3bfe4fec5c7027a7f69378dfe6114a4fb2a2e44ff27c888411", "started": true}], "qosClass": "Guaranteed"}}], "persistentvolumeclaim": [{"metadata": {"name": "persistence-rabbitmq-cluster-server-0", "namespace": "default", "selfLink": "/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-0", "uid": "a471fd81-b775-43ac-a6e5-435388d5af5d", "resourceVersion": "1162", "creationTimestamp": "2021-08-01T07:52:58Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "annotations": {"pv.kubernetes.io/bind-completed": "yes", "pv.kubernetes.io/bound-by-controller": "yes", "volume.beta.kubernetes.io/storage-provisioner": "rancher.io/local-path", "volume.kubernetes.io/selected-node": "kind-worker2"}, "ownerReferences": [{"apiVersion": "rabbitmq.com/v1beta1", "kind": "RabbitmqCluster", "name": "rabbitmq-cluster", "uid": "ff036c0d-4b3f-467d-8bfe-77f734568958", "controller": true, "blockOwnerDeletion": false}], "finalizers": ["kubernetes.io/pvc-protection"], "managedFields": [{"manager": "kube-scheduler", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:52:58Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:volume.kubernetes.io/selected-node": {}}}}}, {"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:53:01Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {"f:pv.kubernetes.io/bind-completed": {}, "f:pv.kubernetes.io/bound-by-controller": {}, "f:volume.beta.kubernetes.io/storage-provisioner": {}}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"ff036c0d-4b3f-467d-8bfe-77f734568958\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:accessModes": {}, "f:resources": {"f:requests": {".": {}, "f:storage": {}}}, "f:volumeMode": {}, "f:volumeName": {}}, "f:status": {"f:accessModes": {}, "f:capacity": {".": {}, "f:storage": {}}, "f:phase": {}}}}]}, "spec": {"accessModes": ["ReadWriteOnce"], "resources": {"requests": {"storage": "10Gi"}}, "volumeName": "pvc-a471fd81-b775-43ac-a6e5-435388d5af5d", "storageClassName": "standard", "volumeMode": "Filesystem"}, "status": {"phase": "Bound", "accessModes": ["ReadWriteOnce"], "capacity": {"storage": "10Gi"}}}, {"metadata": {"name": "persistence-rabbitmq-cluster-server-1", "namespace": "default", "selfLink": "/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-1", "uid": "a1f0e6ad-50e9-44f5-b65f-c37758398cd7", "resourceVersion": "1567", "creationTimestamp": "2021-08-01T07:54:12Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "annotations": {"pv.kubernetes.io/bind-completed": "yes", "pv.kubernetes.io/bound-by-controller": "yes", "volume.beta.kubernetes.io/storage-provisioner": "rancher.io/local-path", "volume.kubernetes.io/selected-node": "kind-worker"}, "ownerReferences": [{"apiVersion": "rabbitmq.com/v1beta1", "kind": "RabbitmqCluster", "name": "rabbitmq-cluster", "uid": "ff036c0d-4b3f-467d-8bfe-77f734568958", "controller": true, "blockOwnerDeletion": false}], "finalizers": ["kubernetes.io/pvc-protection"], "managedFields": [{"manager": "kube-scheduler", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:12Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:volume.kubernetes.io/selected-node": {}}}}}, {"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:15Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {"f:pv.kubernetes.io/bind-completed": {}, "f:pv.kubernetes.io/bound-by-controller": {}, "f:volume.beta.kubernetes.io/storage-provisioner": {}}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"ff036c0d-4b3f-467d-8bfe-77f734568958\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:accessModes": {}, "f:resources": {"f:requests": {".": {}, "f:storage": {}}}, "f:volumeMode": {}, "f:volumeName": {}}, "f:status": {"f:accessModes": {}, "f:capacity": {".": {}, "f:storage": {}}, "f:phase": {}}}}]}, "spec": {"accessModes": ["ReadWriteOnce"], "resources": {"requests": {"storage": "10Gi"}}, "volumeName": "pvc-a1f0e6ad-50e9-44f5-b65f-c37758398cd7", "storageClassName": "standard", "volumeMode": "Filesystem"}, "status": {"phase": "Bound", "accessModes": ["ReadWriteOnce"], "capacity": {"storage": "10Gi"}}}, {"metadata": {"name": "persistence-rabbitmq-cluster-server-2", "namespace": "default", "selfLink": "/api/v1/namespaces/default/persistentvolumeclaims/persistence-rabbitmq-cluster-server-2", "uid": "ffcdbe76-90e5-4264-91ec-29834cf1e224", "resourceVersion": "1570", "creationTimestamp": "2021-08-01T07:54:12Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "annotations": {"pv.kubernetes.io/bind-completed": "yes", "pv.kubernetes.io/bound-by-controller": "yes", "volume.beta.kubernetes.io/storage-provisioner": "rancher.io/local-path", "volume.kubernetes.io/selected-node": "kind-worker"}, "ownerReferences": [{"apiVersion": "rabbitmq.com/v1beta1", "kind": "RabbitmqCluster", "name": "rabbitmq-cluster", "uid": "ff036c0d-4b3f-467d-8bfe-77f734568958", "controller": true, "blockOwnerDeletion": false}], "finalizers": ["kubernetes.io/pvc-protection"], "managedFields": [{"manager": "kube-scheduler", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:12Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:volume.kubernetes.io/selected-node": {}}}}}, {"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "v1", "time": "2021-08-01T07:54:15Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {"f:pv.kubernetes.io/bind-completed": {}, "f:pv.kubernetes.io/bound-by-controller": {}, "f:volume.beta.kubernetes.io/storage-provisioner": {}}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"ff036c0d-4b3f-467d-8bfe-77f734568958\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:accessModes": {}, "f:resources": {"f:requests": {".": {}, "f:storage": {}}}, "f:volumeMode": {}, "f:volumeName": {}}, "f:status": {"f:accessModes": {}, "f:capacity": {".": {}, "f:storage": {}}, "f:phase": {}}}}]}, "spec": {"accessModes": ["ReadWriteOnce"], "resources": {"requests": {"storage": "10Gi"}}, "volumeName": "pvc-ffcdbe76-90e5-4264-91ec-29834cf1e224", "storageClassName": "standard", "volumeMode": "Filesystem"}, "status": {"phase": "Bound", "accessModes": ["ReadWriteOnce"], "capacity": {"storage": "10Gi"}}}], "deployment": [{"metadata": {"name": "rabbitmq-operator", "namespace": "default", "selfLink": "/apis/apps/v1/namespaces/default/deployments/rabbitmq-operator", "uid": "20a8495a-5438-4091-a860-b3c28f25825e", "resourceVersion": "973", "generation": 1, "creationTimestamp": "2021-08-01T07:52:30Z", "labels": {"app.kubernetes.io/component": "rabbitmq-cluster-operator", "app.kubernetes.io/name": "rabbitmq-cluster-operator", "app.kubernetes.io/part-of": "rabbitmq"}, "annotations": {"deployment.kubernetes.io/revision": "1", "kubectl.kubernetes.io/last-applied-configuration": "{\"apiVersion\":\"apps/v1\",\"kind\":\"Deployment\",\"metadata\":{\"annotations\":{},\"labels\":{\"app.kubernetes.io/component\":\"rabbitmq-cluster-operator\",\"app.kubernetes.io/name\":\"rabbitmq-cluster-operator\",\"app.kubernetes.io/part-of\":\"rabbitmq\"},\"name\":\"rabbitmq-operator\",\"namespace\":\"default\"},\"spec\":{\"replicas\":1,\"selector\":{\"matchLabels\":{\"app.kubernetes.io/name\":\"rabbitmq-cluster-operator\",\"sonartag\":\"rabbitmq-operator\"}},\"template\":{\"metadata\":{\"labels\":{\"app.kubernetes.io/component\":\"rabbitmq-cluster-operator\",\"app.kubernetes.io/name\":\"rabbitmq-cluster-operator\",\"app.kubernetes.io/part-of\":\"rabbitmq\",\"sonartag\":\"rabbitmq-operator\"}},\"spec\":{\"containers\":[{\"command\":[\"/manager\"],\"env\":[{\"name\":\"OPERATOR_NAMESPACE\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.namespace\"}}},{\"name\":\"KUBERNETES_SERVICE_HOST\",\"value\":\"kind-control-plane\"},{\"name\":\"KUBERNETES_SERVICE_PORT\",\"value\":\"6443\"}],\"envFrom\":[{\"configMapRef\":{\"name\":\"sonar-testing-global-config\"}}],\"image\":\"laphets/rabbitmq-operator:learn\",\"name\":\"operator\",\"ports\":[{\"containerPort\":9782,\"name\":\"metrics\",\"protocol\":\"TCP\"}],\"resources\":{\"limits\":{\"cpu\":\"200m\",\"memory\":\"500Mi\"},\"requests\":{\"cpu\":\"200m\",\"memory\":\"500Mi\"}}}],\"securityContext\":{\"fsGroup\":1000,\"runAsGroup\":1000,\"runAsUser\":1000},\"serviceAccountName\":\"rabbitmq-cluster-operator\",\"terminationGracePeriodSeconds\":10}}}}\n"}, "managedFields": [{"manager": "kubectl-client-side-apply", "operation": "Update", "apiVersion": "apps/v1", "time": "2021-08-01T07:52:30Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {".": {}, "f:kubectl.kubernetes.io/last-applied-configuration": {}}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}}, "f:spec": {"f:progressDeadlineSeconds": {}, "f:replicas": {}, "f:revisionHistoryLimit": {}, "f:selector": {"f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}, "f:sonartag": {}}}, "f:strategy": {"f:rollingUpdate": {".": {}, "f:maxSurge": {}, "f:maxUnavailable": {}}, "f:type": {}}, "f:template": {"f:metadata": {"f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}, "f:sonartag": {}}}, "f:spec": {"f:containers": {"k:{\"name\":\"operator\"}": {".": {}, "f:command": {}, "f:env": {".": {}, "k:{\"name\":\"KUBERNETES_SERVICE_HOST\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"KUBERNETES_SERVICE_PORT\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"OPERATOR_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}}, "f:envFrom": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":9782,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}}}, "f:dnsPolicy": {}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:terminationGracePeriodSeconds": {}}}}}}, {"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "apps/v1", "time": "2021-08-01T07:52:32Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:annotations": {"f:deployment.kubernetes.io/revision": {}}}, "f:status": {"f:availableReplicas": {}, "f:conditions": {".": {}, "k:{\"type\":\"Available\"}": {".": {}, "f:lastTransitionTime": {}, "f:lastUpdateTime": {}, "f:message": {}, "f:reason": {}, "f:status": {}, "f:type": {}}, "k:{\"type\":\"Progressing\"}": {".": {}, "f:lastTransitionTime": {}, "f:lastUpdateTime": {}, "f:message": {}, "f:reason": {}, "f:status": {}, "f:type": {}}}, "f:observedGeneration": {}, "f:readyReplicas": {}, "f:replicas": {}, "f:updatedReplicas": {}}}}]}, "spec": {"replicas": 1, "selector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster-operator", "sonartag": "rabbitmq-operator"}}, "template": {"metadata": {"creationTimestamp": null, "labels": {"app.kubernetes.io/component": "rabbitmq-cluster-operator", "app.kubernetes.io/name": "rabbitmq-cluster-operator", "app.kubernetes.io/part-of": "rabbitmq", "sonartag": "rabbitmq-operator"}}, "spec": {"containers": [{"name": "operator", "image": "laphets/rabbitmq-operator:learn", "command": ["/manager"], "ports": [{"name": "metrics", "containerPort": 9782, "protocol": "TCP"}], "envFrom": [{"configMapRef": {"name": "sonar-testing-global-config"}}], "env": [{"name": "OPERATOR_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "resources": {"limits": {"cpu": "200m", "memory": "500Mi"}, "requests": {"cpu": "200m", "memory": "500Mi"}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 10, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-operator", "serviceAccount": "rabbitmq-cluster-operator", "securityContext": {"runAsUser": 1000, "runAsGroup": 1000, "fsGroup": 1000}, "schedulerName": "default-scheduler"}}, "strategy": {"type": "RollingUpdate", "rollingUpdate": {"maxUnavailable": "25%", "maxSurge": "25%"}}, "revisionHistoryLimit": 10, "progressDeadlineSeconds": 600}, "status": {"observedGeneration": 1, "replicas": 1, "updatedReplicas": 1, "readyReplicas": 1, "availableReplicas": 1, "conditions": [{"type": "Available", "status": "True", "lastUpdateTime": "2021-08-01T07:52:32Z", "lastTransitionTime": "2021-08-01T07:52:32Z", "reason": "MinimumReplicasAvailable", "message": "Deployment has minimum availability."}, {"type": "Progressing", "status": "True", "lastUpdateTime": "2021-08-01T07:52:32Z", "lastTransitionTime": "2021-08-01T07:52:30Z", "reason": "NewReplicaSetAvailable", "message": "ReplicaSet \"rabbitmq-operator-66cd695d47\" has successfully progressed."}]}}], "statefulset": [{"metadata": {"name": "rabbitmq-cluster-server", "namespace": "default", "selfLink": "/apis/apps/v1/namespaces/default/statefulsets/rabbitmq-cluster-server", "uid": "1cb70b36-745d-4131-84d0-6cbf436c65d3", "resourceVersion": "1890", "generation": 2, "creationTimestamp": "2021-08-01T07:52:58Z", "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "ownerReferences": [{"apiVersion": "rabbitmq.com/v1beta1", "kind": "RabbitmqCluster", "name": "rabbitmq-cluster", "uid": "ff036c0d-4b3f-467d-8bfe-77f734568958", "controller": true, "blockOwnerDeletion": true}], "managedFields": [{"manager": "manager", "operation": "Update", "apiVersion": "apps/v1", "time": "2021-08-01T07:54:12Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:metadata": {"f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}, "f:ownerReferences": {".": {}, "k:{\"uid\":\"ff036c0d-4b3f-467d-8bfe-77f734568958\"}": {".": {}, "f:apiVersion": {}, "f:blockOwnerDeletion": {}, "f:controller": {}, "f:kind": {}, "f:name": {}, "f:uid": {}}}}, "f:spec": {"f:podManagementPolicy": {}, "f:replicas": {}, "f:revisionHistoryLimit": {}, "f:selector": {"f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}}}, "f:serviceName": {}, "f:template": {"f:metadata": {"f:annotations": {".": {}, "f:prometheus.io/port": {}, "f:prometheus.io/scrape": {}}, "f:labels": {".": {}, "f:app.kubernetes.io/component": {}, "f:app.kubernetes.io/name": {}, "f:app.kubernetes.io/part-of": {}}}, "f:spec": {"f:automountServiceAccountToken": {}, "f:containers": {"k:{\"name\":\"rabbitmq\"}": {".": {}, "f:env": {".": {}, "k:{\"name\":\"K8S_HOSTNAME_SUFFIX\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"K8S_SERVICE_NAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"MY_POD_NAME\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"MY_POD_NAMESPACE\"}": {".": {}, "f:name": {}, "f:valueFrom": {".": {}, "f:fieldRef": {".": {}, "f:apiVersion": {}, "f:fieldPath": {}}}}, "k:{\"name\":\"RABBITMQ_ENABLED_PLUGINS_FILE\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_NODENAME\"}": {".": {}, "f:name": {}, "f:value": {}}, "k:{\"name\":\"RABBITMQ_USE_LONGNAME\"}": {".": {}, "f:name": {}, "f:value": {}}}, "f:image": {}, "f:imagePullPolicy": {}, "f:lifecycle": {".": {}, "f:preStop": {".": {}, "f:exec": {".": {}, "f:command": {}}}}, "f:name": {}, "f:ports": {".": {}, "k:{\"containerPort\":4369,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":5672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15672,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}, "k:{\"containerPort\":15692,\"protocol\":\"TCP\"}": {".": {}, "f:containerPort": {}, "f:name": {}, "f:protocol": {}}}, "f:readinessProbe": {".": {}, "f:failureThreshold": {}, "f:initialDelaySeconds": {}, "f:periodSeconds": {}, "f:successThreshold": {}, "f:tcpSocket": {".": {}, "f:port": {}}, "f:timeoutSeconds": {}}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/etc/pod-info/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/10-operatorDefaults.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/11-default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:dnsPolicy": {}, "f:initContainers": {".": {}, "k:{\"name\":\"setup-container\"}": {".": {}, "f:command": {}, "f:image": {}, "f:imagePullPolicy": {}, "f:name": {}, "f:resources": {".": {}, "f:limits": {".": {}, "f:cpu": {}, "f:memory": {}}, "f:requests": {".": {}, "f:cpu": {}, "f:memory": {}}}, "f:securityContext": {".": {}, "f:capabilities": {".": {}, "f:drop": {}}, "f:runAsUser": {}}, "f:terminationMessagePath": {}, "f:terminationMessagePolicy": {}, "f:volumeMounts": {".": {}, "k:{\"mountPath\":\"/operator\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/default_user.conf\"}": {".": {}, "f:mountPath": {}, "f:name": {}, "f:subPath": {}}, "k:{\"mountPath\":\"/tmp/erlang-cookie-secret/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/tmp/rabbitmq-plugins/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}, "k:{\"mountPath\":\"/var/lib/rabbitmq/mnesia/\"}": {".": {}, "f:mountPath": {}, "f:name": {}}}}}, "f:restartPolicy": {}, "f:schedulerName": {}, "f:securityContext": {".": {}, "f:fsGroup": {}, "f:runAsGroup": {}, "f:runAsUser": {}}, "f:serviceAccount": {}, "f:serviceAccountName": {}, "f:terminationGracePeriodSeconds": {}, "f:topologySpreadConstraints": {".": {}, "k:{\"topologyKey\":\"topology.kubernetes.io/zone\",\"whenUnsatisfiable\":\"ScheduleAnyway\"}": {".": {}, "f:labelSelector": {".": {}, "f:matchLabels": {".": {}, "f:app.kubernetes.io/name": {}}}, "f:maxSkew": {}, "f:topologyKey": {}, "f:whenUnsatisfiable": {}}}, "f:volumes": {".": {}, "k:{\"name\":\"erlang-cookie-secret\"}": {".": {}, "f:name": {}, "f:secret": {".": {}, "f:defaultMode": {}, "f:secretName": {}}}, "k:{\"name\":\"plugins-conf\"}": {".": {}, "f:configMap": {".": {}, "f:defaultMode": {}, "f:name": {}}, "f:name": {}}, "k:{\"name\":\"pod-info\"}": {".": {}, "f:downwardAPI": {".": {}, "f:defaultMode": {}, "f:items": {}}, "f:name": {}}, "k:{\"name\":\"rabbitmq-confd\"}": {".": {}, "f:name": {}, "f:projected": {".": {}, "f:defaultMode": {}, "f:sources": {}}}, "k:{\"name\":\"rabbitmq-erlang-cookie\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}, "k:{\"name\":\"rabbitmq-plugins\"}": {".": {}, "f:emptyDir": {}, "f:name": {}}}}}, "f:updateStrategy": {"f:rollingUpdate": {".": {}, "f:partition": {}}, "f:type": {}}, "f:volumeClaimTemplates": {}}}}, {"manager": "kube-controller-manager", "operation": "Update", "apiVersion": "apps/v1", "time": "2021-08-01T07:55:15Z", "fieldsType": "FieldsV1", "fieldsV1": {"f:status": {"f:collisionCount": {}, "f:currentReplicas": {}, "f:currentRevision": {}, "f:observedGeneration": {}, "f:readyReplicas": {}, "f:replicas": {}, "f:updateRevision": {}, "f:updatedReplicas": {}}}}]}, "spec": {"replicas": 3, "selector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster"}}, "template": {"metadata": {"creationTimestamp": null, "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "annotations": {"prometheus.io/port": "15692", "prometheus.io/scrape": "true"}}, "spec": {"volumes": [{"name": "plugins-conf", "configMap": {"name": "rabbitmq-cluster-plugins-conf", "defaultMode": 420}}, {"name": "rabbitmq-confd", "projected": {"sources": [{"secret": {"name": "rabbitmq-cluster-default-user", "items": [{"key": "default_user.conf", "path": "default_user.conf"}]}}, {"configMap": {"name": "rabbitmq-cluster-server-conf", "items": [{"key": "operatorDefaults.conf", "path": "operatorDefaults.conf"}, {"key": "userDefinedConfiguration.conf", "path": "userDefinedConfiguration.conf"}]}}], "defaultMode": 420}}, {"name": "rabbitmq-erlang-cookie", "emptyDir": {}}, {"name": "erlang-cookie-secret", "secret": {"secretName": "rabbitmq-cluster-erlang-cookie", "defaultMode": 420}}, {"name": "rabbitmq-plugins", "emptyDir": {}}, {"name": "pod-info", "downwardAPI": {"items": [{"path": "skipPreStopChecks", "fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.labels['skipPreStopChecks']"}}], "defaultMode": 420}}], "initContainers": [{"name": "setup-container", "image": "rabbitmq:3.8.12-management", "command": ["sh", "-c", "cp /tmp/erlang-cookie-secret/.erlang.cookie /var/lib/rabbitmq/.erlang.cookie && chown 999:999 /var/lib/rabbitmq/.erlang.cookie && chmod 600 /var/lib/rabbitmq/.erlang.cookie ; cp /tmp/rabbitmq-plugins/enabled_plugins /operator/enabled_plugins && chown 999:999 /operator/enabled_plugins ; chown 999:999 /var/lib/rabbitmq/mnesia/ ; echo '[default]' > /var/lib/rabbitmq/.rabbitmqadmin.conf && sed -e 's/default_user/username/' -e 's/default_pass/password/' /tmp/default_user.conf >> /var/lib/rabbitmq/.rabbitmqadmin.conf && chown 999:999 /var/lib/rabbitmq/.rabbitmqadmin.conf && chmod 600 /var/lib/rabbitmq/.rabbitmqadmin.conf"], "resources": {"limits": {"cpu": "100m", "memory": "500Mi"}, "requests": {"cpu": "100m", "memory": "500Mi"}}, "volumeMounts": [{"name": "plugins-conf", "mountPath": "/tmp/rabbitmq-plugins/"}, {"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "erlang-cookie-secret", "mountPath": "/tmp/erlang-cookie-secret/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-confd", "mountPath": "/tmp/default_user.conf", "subPath": "default_user.conf"}], "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent", "securityContext": {"capabilities": {"drop": ["FSETID", "KILL", "SETGID", "SETUID", "SETPCAP", "NET_BIND_SERVICE", "NET_RAW", "SYS_CHROOT", "MKNOD", "AUDIT_WRITE", "SETFCAP"]}, "runAsUser": 0}}], "containers": [{"name": "rabbitmq", "image": "rabbitmq:3.8.12-management", "ports": [{"name": "epmd", "containerPort": 4369, "protocol": "TCP"}, {"name": "amqp", "containerPort": 5672, "protocol": "TCP"}, {"name": "management", "containerPort": 15672, "protocol": "TCP"}, {"name": "prometheus", "containerPort": 15692, "protocol": "TCP"}], "env": [{"name": "MY_POD_NAME", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.name"}}}, {"name": "MY_POD_NAMESPACE", "valueFrom": {"fieldRef": {"apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"name": "RABBITMQ_ENABLED_PLUGINS_FILE", "value": "/operator/enabled_plugins"}, {"name": "K8S_SERVICE_NAME", "value": "rabbitmq-cluster-nodes"}, {"name": "RABBITMQ_USE_LONGNAME", "value": "true"}, {"name": "RABBITMQ_NODENAME", "value": "rabbit@$(MY_POD_NAME).$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}, {"name": "K8S_HOSTNAME_SUFFIX", "value": ".$(K8S_SERVICE_NAME).$(MY_POD_NAMESPACE)"}], "resources": {"limits": {"cpu": "2", "memory": "2Gi"}, "requests": {"cpu": "1", "memory": "2Gi"}}, "volumeMounts": [{"name": "rabbitmq-erlang-cookie", "mountPath": "/var/lib/rabbitmq/"}, {"name": "persistence", "mountPath": "/var/lib/rabbitmq/mnesia/"}, {"name": "rabbitmq-plugins", "mountPath": "/operator"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/10-operatorDefaults.conf", "subPath": "operatorDefaults.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/11-default_user.conf", "subPath": "default_user.conf"}, {"name": "rabbitmq-confd", "mountPath": "/etc/rabbitmq/conf.d/90-userDefinedConfiguration.conf", "subPath": "userDefinedConfiguration.conf"}, {"name": "pod-info", "mountPath": "/etc/pod-info/"}], "readinessProbe": {"tcpSocket": {"port": "amqp"}, "initialDelaySeconds": 10, "timeoutSeconds": 5, "periodSeconds": 10, "successThreshold": 1, "failureThreshold": 3}, "lifecycle": {"preStop": {"exec": {"command": ["/bin/bash", "-c", "if [ ! -z \"$(cat /etc/pod-info/skipPreStopChecks)\" ]; then exit 0; fi; rabbitmq-upgrade await_online_quorum_plus_one -t 604800; rabbitmq-upgrade await_online_synchronized_mirror -t 604800; rabbitmq-upgrade drain -t 604800"]}}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "File", "imagePullPolicy": "IfNotPresent"}], "restartPolicy": "Always", "terminationGracePeriodSeconds": 604800, "dnsPolicy": "ClusterFirst", "serviceAccountName": "rabbitmq-cluster-server", "serviceAccount": "rabbitmq-cluster-server", "automountServiceAccountToken": true, "securityContext": {"runAsUser": 999, "runAsGroup": 999, "fsGroup": 999}, "schedulerName": "default-scheduler", "topologySpreadConstraints": [{"maxSkew": 1, "topologyKey": "topology.kubernetes.io/zone", "whenUnsatisfiable": "ScheduleAnyway", "labelSelector": {"matchLabels": {"app.kubernetes.io/name": "rabbitmq-cluster"}}}]}}, "volumeClaimTemplates": [{"kind": "PersistentVolumeClaim", "apiVersion": "v1", "metadata": {"name": "persistence", "namespace": "default", "creationTimestamp": null, "labels": {"app.kubernetes.io/component": "rabbitmq", "app.kubernetes.io/name": "rabbitmq-cluster", "app.kubernetes.io/part-of": "rabbitmq"}, "ownerReferences": [{"apiVersion": "rabbitmq.com/v1beta1", "kind": "RabbitmqCluster", "name": "rabbitmq-cluster", "uid": "ff036c0d-4b3f-467d-8bfe-77f734568958", "controller": true, "blockOwnerDeletion": false}]}, "spec": {"accessModes": ["ReadWriteOnce"], "resources": {"requests": {"storage": "10Gi"}}, "volumeMode": "Filesystem"}, "status": {"phase": "Pending"}}], "serviceName": "rabbitmq-cluster-nodes", "podManagementPolicy": "Parallel", "updateStrategy": {"type": "RollingUpdate", "rollingUpdate": {"partition": 0}}, "revisionHistoryLimit": 10}, "status": {"observedGeneration": 2, "replicas": 3, "readyReplicas": 3, "currentReplicas": 3, "updatedReplicas": 3, "currentRevision": "rabbitmq-cluster-server-5f8b8665fb", "updateRevision": "rabbitmq-cluster-server-5f8b8665fb", "collisionCount": 0}}]}